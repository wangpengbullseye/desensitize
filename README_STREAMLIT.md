# 数据脱敏工具 - Streamlit Web应用

## 🔒 简介

数据脱敏工具是一个基于Streamlit的Web应用，用于对文本文件中的敏感数字进行脱敏处理和还原。

**核心功能**:
- 🔒 自动识别并替换敏感数字
- 🔓 使用映射文件还原原始数据
- 📦 支持批量处理
- 💾 生成映射文件用于还原

---

## 🚀 快速开始

### 本地运行

```bash
# 1. 进入目录
cd desensitize

# 2. 安装依赖
pip install -r requirements.txt

# 3. 运行应用
streamlit run app.py

# 4. 浏览器访问
# 自动打开 http://localhost:8502
```

---

## 📋 功能说明

### 1. 数据脱敏

**功能**:
- 自动识别文本中的敏感数字
- 使用占位符（￥1￥、￥2￥等）替换
- 保留章节编号、表格编号等结构性数字
- 生成映射文件

**使用步骤**:
1. 上传文件（支持多选）
2. 点击"开始脱敏"
3. 查看脱敏结果
4. 下载脱敏文件和映射文件（ZIP）

### 2. 数据还原

**功能**:
- 使用映射文件还原原始数据
- 支持批量还原

**使用步骤**:
1. 上传脱敏文件
2. 上传映射文件（JSON）
3. 点击"开始还原"
4. 下载还原文件（ZIP）

---

## 📊 支持的文件格式

| 格式 | 扩展名 |
|------|--------|
| Markdown | .md |
| 文本 | .txt |
| CSV | .csv |
| JSON | .json |
| XML | .xml |
| HTML | .html, .htm |
| Python | .py |
| JavaScript | .js |

---

## 🎯 脱敏规则

### 保留的数字（不脱敏）

- ✅ 章节编号（1.1、2.3.1）
- ✅ 表格编号（表1、表A.1）
- ✅ 图片编号（图1、图A.1）
- ✅ 附录编号（附录A、附录A.1）
- ✅ 参考文献编号（[1]）

### 脱敏的数字

- ❌ 文本中的普通数字
- ❌ 数据值
- ❌ 统计数字
- ❌ 测量值

---

## 📝 使用示例

### 脱敏示例

**原始文本**:
```
# 1.1 概述

该矿井深度为500米，年产量达到100万吨。
表1显示了详细数据。
```

**脱敏后**:
```
# 1.1 概述

该矿井深度为￥1￥米，年产量达到￥2￥万吨。
表1显示了详细数据。
```

**映射文件** (JSON):
```json
{
  "￥1￥": "500",
  "￥2￥": "100"
}
```

---

## ⚠️ 注意事项

1. **映射文件管理**
   - ⚠️ 请妥善保管映射文件
   - ⚠️ 映射文件丢失后无法还原
   - ⚠️ 脱敏文件和映射文件需配对使用

2. **文件备份**
   - ⚠️ 建议在脱敏前备份原始文件
   - ⚠️ 不建议对同一文件多次脱敏

3. **编码格式**
   - ⚠️ 推荐使用UTF-8编码
   - ⚠️ 支持GBK编码自动检测

---

## 🐛 常见问题

**Q: 为什么有些数字没有被脱敏？**  
A: 系统会自动保留章节编号、表格编号等结构性数字。

**Q: 映射文件丢失了怎么办？**  
A: 无法还原，请务必保管好映射文件。

**Q: 可以对同一个文件多次脱敏吗？**  
A: 不建议，会导致映射关系混乱。

**Q: 支持哪些编码格式？**  
A: 支持UTF-8和GBK编码。

---

## 📦 文件清单

```
desensitize/
├── app.py                              # Streamlit Web应用
├── advanced_desensitize_markdown.py    # 核心脱敏逻辑
├── requirements.txt                    # Python依赖
├── .streamlit/
│   └── config.toml                    # Streamlit配置
├── README_STREAMLIT.md                # 本文档
└── test/                              # 测试文件
```

---

## ☁️ 部署到云端

### Streamlit Cloud

1. 将代码推送到GitHub
2. 访问 [share.streamlit.io](https://share.streamlit.io)
3. 连接GitHub仓库
4. 选择 `desensitize/app.py` 作为主文件
5. 点击部署

### Docker

```bash
# 构建镜像
docker build -t desensitize-app .

# 运行容器
docker run -p 8502:8502 desensitize-app
```

---

## 🔗 相关工具

- **命令行版本**: `advanced_desensitize_markdown.py`
- **GUI版本**: `gui_desensitize.py`
- **Web版本**: `app.py` (本应用)

---

## 📞 技术支持

如有问题，请：
- 查看帮助文档（应用内Tab 3）
- 提交GitHub Issue
- 联系技术支持团队

---

**版本**: 1.0.0  
**更新日期**: 2024-12-26  
**维护单位**: 数据安全工作组

